{"ast":null,"code":"import _objectSpread from\"L:/Bacon/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useRef,useState}from'react';import'./WordRush.css';import'../App.css';import data from'./words.json';import{WordCard}from'./wordCard';import{PopupRolesWordRush,PopupGameEnd}from'../PopUps/popup';import{UpdateWordRushGameScore}from'../db/firebase';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";let phasers=0;let currentPhaser=[];let themeSelect=\"\";const TimeToDestroyWords=5600;function WordLostStatus(status,setStatus,word){if(word==undefined)return;const length=word.length;setStatus(prev=>_objectSpread(_objectSpread({},prev),{},{[String(length)]:(prev[String(length)]||0)+1}));}function selectRandomTheme(){const obj=Object.keys(data.themes);const themeIndex=Math.floor(Math.random()*obj.length);const theme=obj[themeIndex];return theme;}function getNextWords(theme){if(phasers>=Object.keys(theme).length)return undefined;if(currentPhaser.length===0&&phasers<Object.keys(theme).length-1){phasers++;currentPhaser=theme[phasers].phasers.split(\" \");}return currentPhaser.shift();}export function WordsContainer(){const[words,setWords]=useState([]);const[playerInput,setPlayerInput]=useState(\"\");const[popupState,setPopupState]=useState(true);const[updateWords,setUpdateWords]=useState(0);const[score,setScore]=useState(0);const[finished,setFinished]=useState(false);const[save,setSave]=useState(false);const[LostWordStatus,setLostWordStatus]=useState({});const inputRef=useRef(null);if(themeSelect===\"\")themeSelect=selectRandomTheme();useEffect(()=>{const update=setInterval(()=>setUpdateWords(prev=>prev+1),500);return()=>clearInterval(update);},[]);useEffect(()=>{var _inputRef$current;if(popupState){phasers=0;currentPhaser=[];return;}(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();const spawn=setInterval(()=>{const word=getNextWords(data.themes[themeSelect]);setWords(prev=>[...prev,{\"word\":word,\"right\":Math.floor(Math.random()*40)+5,\"createAt\":Date.now()}]);},1000);return()=>clearInterval(spawn);},[popupState]);useEffect(()=>{if(words[0]&&Date.now()-words[0].createAt>TimeToDestroyWords)WordLostStatus(LostWordStatus,setLostWordStatus,words[0].word);setWords(words.filter(x=>Date.now()-x.createAt<TimeToDestroyWords));},[updateWords]);useEffect(()=>{if(words.length===0)return;const first=words[0];if(first.word===undefined)setFinished(true);},[words]);useEffect(()=>{if(!words[0]||!words[0].word)return;if(playerInput.toLowerCase()!==words[0].word.toLowerCase())return;setPlayerInput(\"\");setWords(words.slice(1));setScore(score+100);},[playerInput,words]);if(popupState)return/*#__PURE__*/_jsx(PopupRolesWordRush,{setState:setPopupState});if(finished){if(!save){UpdateWordRushGameScore(score,LostWordStatus);setSave(true);}return/*#__PURE__*/_jsx(PopupGameEnd,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"GamePage\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"WordsContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"NoteBookContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"RingsContainer\",children:Array(Math.floor(window.innerWidth/2*0.45/45)).fill(null).map(x=>/*#__PURE__*/_jsx(\"div\",{className:\"Ring\"}))}),/*#__PURE__*/_jsx(\"div\",{className:\"Page\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"Score:\"}),\" \",String(score).padStart(3,\"0\"),\" \"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"WordCascade\",children:words.map(x=>/*#__PURE__*/_jsx(WordCard,{Word:x.word,posX:x.right},x.createAt))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"PlayerInputContainer\",children:/*#__PURE__*/_jsx(\"input\",{className:\"PlayerInput\",ref:inputRef,type:\"text\",value:playerInput,onChange:event=>setPlayerInput(event.target.value),placeholder:\"Write here\"})})]});}","map":{"version":3,"names":["useEffect","useRef","useState","data","WordCard","PopupRolesWordRush","PopupGameEnd","UpdateWordRushGameScore","jsx","_jsx","jsxs","_jsxs","phasers","currentPhaser","themeSelect","TimeToDestroyWords","WordLostStatus","status","setStatus","word","undefined","length","prev","_objectSpread","String","selectRandomTheme","obj","Object","keys","themes","themeIndex","Math","floor","random","theme","getNextWords","split","shift","WordsContainer","words","setWords","playerInput","setPlayerInput","popupState","setPopupState","updateWords","setUpdateWords","score","setScore","finished","setFinished","save","setSave","LostWordStatus","setLostWordStatus","inputRef","update","setInterval","clearInterval","_inputRef$current","current","focus","spawn","Date","now","createAt","filter","x","first","toLowerCase","slice","setState","className","children","Array","window","innerWidth","fill","map","padStart","Word","posX","right","ref","type","value","onChange","event","target","placeholder"],"sources":["L:/Bacon/src/WordRush/WordRush.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react'\r\nimport './WordRush.css'\r\nimport '../App.css'\r\nimport data from './words.json'\r\nimport { WordCard } from './wordCard'\r\nimport { PopupRolesWordRush, PopupGameEnd } from '../PopUps/popup'\r\nimport { UpdateWordRushGameScore } from '../db/firebase'\r\nlet phasers = 0\r\nlet currentPhaser = []\r\nlet themeSelect = \"\"\r\nconst TimeToDestroyWords = 5600\r\n\r\nfunction WordLostStatus(status, setStatus, word){\r\n    if (word == undefined) return\r\n    const length = word.length\r\n    setStatus(prev => ({\r\n        ...prev,\r\n        [String(length)]: (prev[String(length)] || 0) + 1\r\n    }))\r\n}\r\n\r\nfunction selectRandomTheme(){\r\n    const obj = Object.keys(data.themes)\r\n    const themeIndex = Math.floor(Math.random() * obj.length)\r\n    const theme = obj[themeIndex]\r\n    return theme\r\n}\r\n\r\nfunction getNextWords(theme){\r\n    if (phasers >= Object.keys(theme).length) return undefined\r\n    if (currentPhaser.length === 0 && phasers < Object.keys(theme).length - 1){\r\n        phasers++\r\n        currentPhaser = theme[phasers].phasers.split(\" \")\r\n    }\r\n    return currentPhaser.shift()\r\n}\r\n\r\nexport function WordsContainer(){\r\n    const [words,setWords] = useState([])\r\n    const [playerInput,setPlayerInput] = useState(\"\")\r\n    const [popupState, setPopupState] = useState(true)\r\n    const [updateWords, setUpdateWords] = useState(0)\r\n    const [score, setScore] = useState(0)\r\n    const [finished, setFinished] = useState(false)\r\n    const [save, setSave] = useState(false)\r\n    const [LostWordStatus, setLostWordStatus] = useState({})\r\n    const inputRef = useRef(null)\r\n\r\n    if (themeSelect === \"\") themeSelect = selectRandomTheme()\r\n    \r\n    useEffect(() => {\r\n        const update = setInterval(() => setUpdateWords(prev => prev + 1),500)\r\n        return () => clearInterval(update)\r\n    },[])\r\n    \r\n    useEffect(() => {\r\n            if (popupState){\r\n                phasers = 0\r\n                currentPhaser = []\r\n                return\r\n            }\r\n            inputRef.current?.focus()\r\n            const spawn = setInterval(() => {\r\n                const word = getNextWords(data.themes[themeSelect])\r\n                setWords(prev => [...prev,{ \"word\": word, \"right\": (Math.floor(Math.random() * 40) + 5), \"createAt\": Date.now()}])\r\n            },1000)\r\n            return () => clearInterval(spawn)\r\n        }\r\n    ,[popupState])\r\n\r\n    useEffect(() => {\r\n        if (words[0] && (Date.now() - words[0].createAt) > TimeToDestroyWords)\r\n            WordLostStatus(LostWordStatus,setLostWordStatus,words[0].word)\r\n        setWords(words.filter((x) => Date.now() - x.createAt < TimeToDestroyWords))\r\n    },[updateWords])\r\n    useEffect(() => {\r\n        if (words.length === 0) return\r\n        const first = words[0]\r\n        if (first.word === undefined) setFinished(true)\r\n    },[words])\r\n\r\n    useEffect(() => {\r\n        if (!words[0] || !words[0].word) return\r\n        if (playerInput.toLowerCase() !== words[0].word.toLowerCase()) return\r\n        setPlayerInput(\"\")\r\n        setWords(words.slice(1))\r\n        setScore(score + 100)\r\n    },[playerInput,words])\r\n\r\n    if (popupState) return <PopupRolesWordRush setState={setPopupState}/>\r\n    if (finished){\r\n        if (!save){\r\n            UpdateWordRushGameScore(score,LostWordStatus)\r\n            setSave(true)\r\n        }\r\n        return <PopupGameEnd/>\r\n    }\r\n    return (\r\n        <div className='GamePage'>\r\n            <div className='WordsContainer'>\r\n                <div className='NoteBookContainer'>\r\n                    <div className='RingsContainer'>\r\n                        {\r\n                            Array(Math.floor(((window.innerWidth/2) * 0.45)/45)).fill(null).map((x) => <div className='Ring'></div>)\r\n                        }\r\n                    </div>\r\n                    <div className='Page'>\r\n                        <span> <strong>Score:</strong> {String(score).padStart(3,\"0\")} </span>\r\n                    </div>\r\n                </div>\r\n                <div className='WordCascade'>\r\n                    {\r\n                        words.map((x) => <WordCard key={x.createAt} Word={x.word} posX={x.right} />)\r\n                    }\r\n                </div>\r\n            </div>\r\n            <div className='PlayerInputContainer'>\r\n                <input className='PlayerInput'\r\n                    ref={inputRef}\r\n                    type='text'\r\n                    value={playerInput}\r\n                    onChange={(event) => setPlayerInput(event.target.value)}\r\n                    placeholder='Write here'\r\n                ></input>\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}